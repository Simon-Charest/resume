<%- include('header') %>

        <div class="body-about">

            <div class="box profile">

                <div class="jumbotron">
                    <img src="/assets/images/<%= images.background %>" class="background-image">
                    <img src="/assets/images/profile/<%= profilePicture %>" class="profile-image" title="<%= profilePicture %>">
                </div>

                <div class="intro">
                    <div>
                        <h1><%= data.intro.firstName %> <%= data.intro.lastName %></h1>
                        <p><strong><%= data.intro.primaryPosition.title[lang] %></strong></p>
                        <p><%= data.intro.location.city[lang] %>, <%= data.intro.location.province[lang] %>, <%= data.intro.location.country[lang] %></p>
                    </div>

                    <div>
                        <ul class="list-style-type-none">
                            <% const ongoingExperiences = data.experience.filter(experience => experience.endDate === null); %>
                            <% ongoingExperiences.forEach(experience => { %>
                                <% if (experience.company) { %>
                                    <li>
                                        <img src="/assets/images/<%= experience.icon %>" class="icon icon-32x32">
                                        <a href="<%= experience.company.url[lang] %>"><%= experience.company.name[lang] %></a>
                                    </li>
                                <% } %>
                            <% }); %>
                            <% const obtainedDegrees = data.education.filter(education => education.degree !== null && education.higherEducation); %>
                            <% obtainedDegrees.forEach(education => { %>
                                <li>
                                    <img src="/assets/images/<%= education.icon %>" class="icon icon-32x32">
                                    <a href="<%= education.school.url[lang] %>"><%= education.school.name[lang] %></a>
                                </li>
                            <% }); %>
                        </ul>
                    </div>
                </div>

                <hr>

                <div class="contact-info">
                    <h3><%= data.globals.contactInfo[lang] %></h3>
                    <button class="collapsible-button"><%= data.seeMore[lang] %></button>
                    <div class="collapsible-content">
                        <ul class="list-style-type-none">
                            <li><img src="/assets/icons/<%= icons.linked_in %>" class="icon icon-16x16"><strong><%= data.globals.profile[lang] %></strong>&nbsp;<a href="<%= data.intro.contactInfo.profile.url %>"><%= data.intro.contactInfo.profile.name %></a></li>
                            <li>
                                <img src="/assets/icons/<%= icons.website %>" class="icon icon-16x16">
                                <strong><%= data.globals.websites[lang] %></strong>&nbsp;
                                <% data.intro.contactInfo.websites.forEach((item, index) => { %>
                                    <a href="<%= item.url %>"><%= item.name[lang] %></a>&nbsp;(<%= item.type[lang] %>)<% if (index < data.intro.contactInfo.websites.length - 1) { %>, <% } %>
                                <% }); %>
                            </li>
                            <li><img src="/assets/icons/<%= icons.phone %>" class="icon icon-16x16"><strong><%= data.globals.phone[lang] %></strong>&nbsp;<a href="tel:<%= data.intro.contactInfo.phone.number %>"><%= data.intro.contactInfo.phone.number %></a>&nbsp;(<%= data.intro.contactInfo.phone.type %>)</li>
                            <%
                                const address = {
                                    apartment: data.intro.contactInfo.address.apartment,
                                    civicNumber: data.intro.contactInfo.address.civicNumber,
                                    streetName: data.intro.contactInfo.address.streetName,
                                    roadType: data.intro.contactInfo.address.roadType,
                                    postalCode: data.intro.contactInfo.address.postalCode,
                                    city: data.intro.contactInfo.address.city[lang],
                                    province: data.intro.contactInfo.address.province[lang],
                                    country: data.intro.contactInfo.address.country[lang]
                                };

                                // Build the address parts array dynamically
                                const parts = [
                                    address.civicNumber,
                                    address.streetName,
                                    address.postalCode,
                                    address.city,
                                    address.province,
                                    address.country
                                ].filter(Boolean);

                                // Join the non-empty parts with a comma
                                const addressString = parts.join(', ');
                            %>

                            <li><img src="/assets/icons/<%= icons.address %>" class="icon icon-16x16"><strong><%= data.globals.address[lang] %></strong>&nbsp;<a href="https://www.google.ca/maps/place/<%= addressString %>"><%= data.globals.GoogleMaps %></a></li>
                            <li><img src="/assets/icons/<%= icons.email %>" class="icon icon-16x16"><strong><%= data.globals.email[lang] %></strong>&nbsp;<a href="mailto:<%= data.intro.contactInfo.email.url %>"><%= data.intro.contactInfo.email.name %></a></li>
                            <% if (data.intro.contactInfo.birthday) { %>
                                <li><img src="/assets/icons/<%= icons.birthday %>" class="icon icon-16x16"><%= data.globals.birthday[lang] %>&nbsp;<%= data.intro.contactInfo.birthday %></li>
                            <% } %>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="box">
                <h2><%= data.globals.about[lang] %></h2>
                <button class="collapsible-button"><%= data.seeMore[lang] %></button>
                <div class="collapsible-content">
                    <ul class="list-style-type-none">
                        <% data.about_.forEach(item => { %>
                            <li class="padded-li">
                                <strong><%= item.name[lang] %></strong>
                                <br><%= item.description[lang] %>
                            </li>
                        <% }); %>
                    </ul>
                </div>

                <div class="top-skills">
                    <h3><img src="/assets/icons/<%= icons.skill %>" class="icon icon-16x16"><%= data.globals.topSkills[lang] %></h3>
                    <ul class="horizontal-list">
                        <% data.topSkills.forEach(topSkill => { %>
                            <li><%= topSkill %></li>
                        <% }); %>
                    </ul>
                </div>
            </div>

            <div class="box">
                <h2><%= data.globals.experience[lang] %></h2>
                <% data.experience.forEach((item, index) => { %>
                    <div class="card-row">
                        <img src="/assets/images/<%= item.icon || 'company.png' %>" class="icon icon-48x48">
                        <div class="card-text">
                            <strong><%= item.title[lang] %></strong>
                            <% if (item.company) { %>
                                <br>
                                <% if (item.company.url) { %>
                                    <a href="<%= item.company.url[lang] %>">
                                <% } %>
                                <%= item.company.name[lang] %>
                                <% if (item.company.url) { %>
                                    </a>
                                <% } %>
                                ·
                                <%= item.employmentType[lang] %>
                            <% } %>
                            <span class="gray">
                                <br><%= item.startDate.slice(0, 7) %> - <%= item.endDate ? item.endDate.slice(0, 7) : data.globals.present[lang] %> · <%= formatLength(calculateLength(item.startDate, item.endDate), lang) %>
                                <br><%= item.location.city[lang] %> - <%= item.location.type[lang] %>
                            </span>
                            <% if (item.descriptions) { %>
                                <div>
                                    <button class="collapsible-button"><%= data.seeMore[lang] %></button>
                                    <div class="collapsible-content">

                                        <% item.descriptions.forEach(description => { %>
                                            <strong><%= description.key[lang] %></strong>
                                            <ul class="list-style-type-disc">
                                                <% description.values.forEach(value => { %>
                                                    <li><%= value[lang] %></li>
                                                <% }); %>
                                            </ul>
                                        <% }); %>

                                    </div>
                                </div>
                            <% } %>

                            <% if (item.skills) { %>
                                <p>
                                    <h3><img src="/assets/icons/<%= icons.skill %>" class="icon"> <%= data.globals.skills[lang] %></h3>
                                    <ul class="horizontal-list">
                                        <% item.skills.forEach(skill => { %>
                                            <li><%= skill %></li>
                                        <% }); %>
                                    </ul>
                                </p>
                            <% } %>
                        </div>
                    </div>
                    
                    <% if (index < data.experience.length - 1) { %>
                        <hr>
                    <% } %>
                <% }); %>      
            </div>

            <div class="box">
                <h2><%= data.globals.skills[lang] %></h2>
                <ul class="list-style-type-none">
                    <% data.skills.forEach((skill, index) => { %>
                        <li>
                            <strong><%= skill.category.name[lang] %>:</strong>
                            <span><%= skill.category.technologies.map(t => t.name[lang]).join(', ') %></span>
                        </li>
                        <% if (index < data.skills.length - 1) { %>
                            <hr>
                        <% } %>
                    <% }); %>
                </ul>
            </div>

            <div class="box">
                <h2><%= data.globals.courses[lang] %></h2>
                <ul class="list-style-type-none">
                    <% data.courses.forEach((course, index) => { %>
                        <li>
                            <%= course.name[lang] %><% if (course.code) { %> (<span class="gray"><%= course.code %></span>)<% } %>
                            <br><span class="gray"><%= course.startDate %><% if (course.endDate && course.endDate > course.startDate) { %> - <%= course.endDate %><% } %></span>
                        </li>
                        <% if (index < data.courses.length - 1) { %>
                            <hr>
                        <% } %>
                    <% }); %>
                </ul>
            </div>

            <div class="box">
                <h2><%= data.globals.education[lang] %></h2>
                <% data.education.forEach((item, index) => { %>
                    <div class="card-row">
                        <img src="/assets/images/<%= item.icon || 'school.png' %>" class="icon icon-48x48">
                        <div class="card-text">
                            <strong><%= item.title[lang] %></strong>
                            <% if (item.degree) { %>
                                <br><%= item.degree[lang] %>
                            <% } %>
                            <br><% if (item.school.url) { %><a href="<%= item.school.url[lang] %>"><% } %><%= item.school.name[lang] %><% if (item.school.url) { %></a><% } %>
                            <span class="gray">
                                <br><%= item.startDate.slice(0, 4) %> 
                                <% if (item.endDate) { %>
                                    <% if (parseInt(item.endDate.slice(0, 4)) > parseInt(item.startDate.slice(0, 4))) { %>
                                        - <%= item.endDate.slice(0, 4) %>
                                    <% } %>
                                <% } else { %>
                                    - <%= data.globals.present[lang] %>
                                <% } %>
                                <br><%= item.location.city[lang] %>
                                <% if (item.relationships && item.relationships.length > 0) { %>
                                    <br><%= data.globals.relationships[lang] %>:
                                    <% item.relationships.forEach((relationship, index) => { %>
                                        <a href="<%= relationship.url[lang] %>"><%= relationship.name[lang] %></a> (<%= relationship.type[lang] %>)<% if (index < item.relationships.length - 1) { %>, <% } %>
                                    <% }); %>
                                <% } %>
                            </span>
                            <div>
                                <% if (item.descriptions) { %>
                                    <div>
                                        <button class="collapsible-button"><%= data.seeMore[lang] %></button>
                                        <div class="collapsible-content">
    
                                            <% item.descriptions.forEach(description => { %>
                                                <strong><%= description.key[lang] %></strong>
                                                <ul class="list-style-type-disc">
                                                    <% description.values.forEach(value => { %>
                                                        <li><%= value[lang] %></li>
                                                    <% }); %>
                                                </ul>
                                            <% }); %>
    
                                        </div>
                                    </div>
                                <% } %>
                            </div>
                        </div>
                    </div>

                    <% if (index < data.education.length - 1) { %>
                        <hr>
                    <% } %>
                <% }); %>
            </div>

            <div class="box">
                <h2><%= data.globals.languages[lang] %></h2>
                <ul class="list-style-type-none">
                    <% data.languages.forEach((language, index) => { %>
                        <li>
                            <img src="/assets/icons/<%= language.icon %>" class="icon icon-flag"><%= language.name[lang] %>
                            <br><span class="gray"><%= language.proficiency[lang] %></span>
                        </li>
                        <% if (index < data.languages.length - 1) { %>
                            <hr>
                        <% } %>
                    <% }); %>
                </ul>
            </div>

            <div class="box">
                <h2><%= data.globals.interests[lang] %></h2>
                <ul class="list-style-type-none">
                    <% data.interests.forEach((interest, index) => { %>
                        <li>
                            <%= interest.name[lang] %>
                        </li>
                        <% if (index < data.interests.length - 1) { %>
                            <hr>
                        <% } %>
                    <% }); %>
                </ul>
            </div>
            
            <div class="box">
                <h2><%= data.globals.recommandations[lang] %></h2>
                <ul class="list-style-type-none">
                    <% data.recommandations.forEach((recommandation, index) => { %>
                        <li>
                            <a href="<%= recommandation.url %>"><%= recommandation.name %></a>
                        </li>
                        <% if (index < data.recommandations.length - 1) { %>
                            <hr>
                        <% } %>
                    <% }); %>
                </ul>
            </div>

        </div>

<%- include('footer') %>
